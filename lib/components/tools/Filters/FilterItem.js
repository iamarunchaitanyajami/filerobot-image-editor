import React,{memo,useCallback,useEffect,useRef}from"react";import{Layer,Image}from"react-konva";import{StyledFilterItem,FilterItemPreview,FilterItemLabel}from"./Filters.styled";var MAX_FILTER_PREVIEW_WIDTH=60,MAX_FILTER_PREVIEW_HEIGHT=45,FilterItem=function(a){var b=a.filterLabel,c=a.filterFn,d=void 0===c?void 0:c,e=a.applyFilter,f=a.isActive,g=a.image,h=useRef(),i=useCallback(function(){e(d)},[d]),j=useCallback(function(){h.current?h.current.cache():setTimeout(j,0)},[]);useEffect(function(){return g&&j(),function(){var a;null===(a=h.current)||void 0===a||a.clearCache()}},[g]);var k=g.width/g.height,l=1>k,m=l?MAX_FILTER_PREVIEW_WIDTH:MAX_FILTER_PREVIEW_HEIGHT*k,n=l?MAX_FILTER_PREVIEW_WIDTH/k:MAX_FILTER_PREVIEW_HEIGHT;return React.createElement(StyledFilterItem,{className:"FIE_filters-item",onClick:i,"aria-selected":f},React.createElement(FilterItemPreview,{className:"FIE_filters-item-preview",width:MAX_FILTER_PREVIEW_WIDTH,height:MAX_FILTER_PREVIEW_HEIGHT},React.createElement(Layer,{onTap:i},React.createElement(Image,{image:g,filters:d?[d]:[],width:m,height:n,x:-(m-MAX_FILTER_PREVIEW_WIDTH)/2,y:-(n-MAX_FILTER_PREVIEW_HEIGHT)/2,ref:h}))),React.createElement(FilterItemLabel,{className:"FIE_filters-item-label"},b))};export default memo(FilterItem);