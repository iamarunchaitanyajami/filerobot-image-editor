import _defineProperty from"@babel/runtime/helpers/defineProperty";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}import React from"react";import LockOutline from"@scaleflex/icons/lock-outline";import UnlockOutline from"@scaleflex/icons/unlock-outline";import{Reset}from"@scaleflex/icons";import{SET_RESIZE,ZOOM_CANVAS}from"../../../actions";import{useStore}from"../../../hooks";import getProperDimensions from"../../../utils/getProperDimensions";import getSizeAfterRotation from"../../../utils/getSizeAfterRotation";import getZoomFitFactor from"../../../utils/getZoomFitFactor";import restrictNumber from"../../../utils/restrictNumber";import{DEFAULT_ZOOM_FACTOR}from"../../../utils/constants";import{StyledResizeWrapper,StyledResizeInput,StyledRatioLockIcon,StyledResetButton}from"./Resize.styled";var Resize=function(a){var b=a.onChange,c=void 0===b?void 0:b,d=a.currentSize,e=void 0===d?{}:d,f=a.hideResetButton,g=a.alignment,h=void 0===g?"center":g,i=useStore(),j=i.dispatch,k=i.originalImage,l=i.resize,m=i.shownImageDimensions,n=i.adjustments,o=n.crop,p=n.rotation,q=void 0===p?0:p,r=i.theme,s=i.t,t=function(a){var b,d=a.target,f=d.name,g=d.value;if(!(1>parseFloat(g))){var h=Math.min(10*k.width,10*k.height),i=getSizeAfterRotation(k.width,k.height,q),n=_defineProperty({},f,g?restrictNumber(g,0,h):g),p="height"===f,r=p?"width":"height",s=null!==(b=e.ratioUnlocked)&&void 0!==b?b:l.ratioUnlocked;if(!s){var t=i.width/i.height;n[r]=p?Math.round(n[f]*t):Math.round(n[f]/t)}if(n[f]!==l[f]||n[r]!==l[r]){if("function"==typeof c)return void c(n);j({type:SET_RESIZE,payload:n});var u=o.width&&o.height&&o||m,v=_objectSpread(_objectSpread({},l),n);j({type:ZOOM_CANVAS,payload:{factor:v.width&&v.height?getZoomFitFactor(u,v):DEFAULT_ZOOM_FACTOR,isAbsoluteZoom:!0}})}}},u="undefined"==typeof l.width&&"undefined"==typeof l.height||k.width===l.width&&k.height===l.height,v=getProperDimensions((e.width||e.height)&&e||l,o,m,k,q),w=l.manualChangeDisabled,x="undefined"!=typeof l.width&&!l.width,y="undefined"!=typeof l.height&&!l.height;return React.createElement(StyledResizeWrapper,{className:"FIE_resize-tool-options",alignment:h},React.createElement(StyledResizeInput,{className:"FIE_resize-width-option",value:x?"":v.width,name:"width",onChange:w?void 0:t,inputMode:"numeric",title:s("resizeWidthTitle"),label:s("width"),inputProps:{type:"number"},size:"sm",iconEnd:"px",placeholder:"Width",disabled:w}),React.createElement(StyledRatioLockIcon,{className:"FIE_resize-ratio-locker",title:s("toggleRatioLockTitle"),onClick:w?void 0:function toggleRatioLock(){return"function"==typeof c?void c({ratioUnlocked:!e.ratioUnlocked}):void j({type:SET_RESIZE,payload:{ratioUnlocked:!l.ratioUnlocked}})},color:"basic",size:"sm",disabled:w},e.ratioUnlocked||l.ratioUnlocked?React.createElement(UnlockOutline,{size:16,color:r.palette.success}):React.createElement(LockOutline,{size:16,color:r.palette.error})),React.createElement(StyledResizeInput,{className:"FIE_resize-height-option",value:y?"":v.height,name:"height",onChange:w?void 0:t,inputMode:"numeric",title:s("resizeHeightTitle"),label:s("height"),inputProps:{type:"number"},size:"sm",iconEnd:"px",placeholder:"Height",disabled:w}),!(void 0!==f&&f)&&React.createElement(StyledResetButton,{className:"FIE_resize-reset-button",size:"sm",color:"basic",onClick:u||w?void 0:function resetResize(){j({type:SET_RESIZE,payload:{width:void 0,height:void 0,ratioUnlocked:!1}});var a=o.width&&o.height&&o||m;j({type:ZOOM_CANVAS,payload:{factor:getZoomFitFactor(a,a)}})},disabled:u||w},React.createElement(Reset,null)))};export default Resize;